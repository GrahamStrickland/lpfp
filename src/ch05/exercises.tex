% Answers for exercises in ch05

\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}

\title{
    Learn Physics with Functional Programming\\---\\Scott N. Walck\\---\\
    Chapter 5: Exercises
}
\author{Graham Strickland}

\begin{document}
\maketitle  

    \begin{itemize}
        \item[5.4] We have the function \verb|range| with the following definition:
        \begin{verbatim}
range :: Int -> [Int]
range x = if x >= 0
          then [0..x]
          else [x..0]
        \end{verbatim}
        \verb|range| returns a list containing all the integers between the argument 
        (inclusive) and 0 in increasing order, i.e, $\text{range}(2) = 0, 1, 2$, 
        $\text{range}(-4) = -4, -3, \ldots, 0$, and $\text{range}(0) = 0$.\par
        \qquad We demonstrate as follows:
        \begin{verbatim}
ghci> range (-4)
[-4,-3,-2,-1,0]
ghci> range 2
[0,1,2]
ghci> range (-4)
[-4,-3,-2,-1,0]
ghci> range 0
[0]
        \end{verbatim}
        \item[5.5] We have the function \verb|null'| with the following definition:
        \begin{verbatim}
import Data.Foldable

null' :: (Foldable t) => t a -> Bool
null' xs = case toList xs of
  [] -> True
  (_ : _) -> False
        \end{verbatim}
        \verb|null'| returns \verb|True| if an argument \verb|t| of type \verb|a| 
        is empty, otherwise \verb|False|. Since we are using the \verb|Foldable| 
        type, we import \verb|Data.Foldable|.\par
        \qquad We demonstrate as follows:
        \begin{verbatim}
ghci> null' []
True
ghci> null' [1, 2, 3]
False
ghci> null' [1..]
False
        \end{verbatim}
        \item[5.6] We have the function \verb|last'| with the following definition
        \begin{verbatim}
import GHC.Stack (HasCallStack)

last' :: HasCallStack => [a] -> a 
last' x = head (reverse x)
        \end{verbatim}
        \verb|last'| returns the last item in an argument with type that implements 
        \verb|HasCallStack|, an error if the argument is empty, or hangs indefinitely
        if the variable has infinite length.\par
        \qquad We demonstrate as follows:
        \begin{verbatim}
ghci> last' [1, 2, 3]
3
ghci> last' ["check", "mate"]
"mate"
ghci> last' []
*** Exception: Prelude.head: empty list
CallStack (from HasCallStack):
  error, called at libraries/base/GHC/List.hs:1646:3 
    in base:GHC.List
  errorEmptyList, called at libraries/base/GHC/List.hs:85:11 
    in base:GHC.List
  badHead, called at libraries/base/GHC/List.hs:81:28 
    in base:GHC.List
  head, called at last.hs:4:11 in main:Main
  last', called at <interactive>:4:1 in interactive:Ghci3
        \end{verbatim}
        \item[5.7] We have the function \verb|palindrome| with the following 
        definition 
        \begin{verbatim}
import Distribution.Simple.Utils

palindrome :: String -> Bool
palindrome s = reverse (lowercase s) == lowercase s 
        \end{verbatim}
        \verb|palindrome| uses the function 
        \verb|Distribution.Simple.Utils.lowercase| to check if the lowercase version 
        of a string is the same as the lowercase version reversed, i.e., is the 
        string a palindrome.\par
        \qquad We demonstrate as follows:
        \begin{verbatim}
ghci> palindrome "Radar"
True
ghci> palindrome "MadamImAdam"
True
ghci> palindrome "racecar"
True
ghci> palindrome "dog"
False
        \end{verbatim}
    \end{itemize}
\end{document}
